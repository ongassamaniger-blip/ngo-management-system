// Ã‡OK DÄ°LLÄ° DESTEK - i18n (Internationalization)

// Dil Ã§evirileri
const translations = {
    tr: {
        // Genel
        'welcome': 'HoÅŸ Geldiniz',
        'logout': 'Ã‡Ä±kÄ±ÅŸ',
        'save': 'Kaydet',
        'cancel': 'Ä°ptal',
        'delete': 'Sil',
        'edit': 'DÃ¼zenle',
        'search': 'Ara...',
        'loading': 'YÃ¼kleniyor...',
        
        // MenÃ¼
        'dashboard': 'Dashboard',
        'finance': 'Finans',
        'facilities': 'Tesisler',
        'projects': 'Projeler',
        'sacrifice': 'Kurban',
        'personnel': 'Personel',
        'profile': 'Profil',
        'users': 'KullanÄ±cÄ±lar',
        
        // Dashboard
        'overview': 'Genel BakÄ±ÅŸ',
        'totalIncome': 'Toplam Gelir',
        'totalExpense': 'Toplam Gider',
        'balance': 'Bakiye',
        'activeFacilities': 'Aktif Tesisler',
        'recentTransactions': 'Son Ä°ÅŸlemler',
        'thisMonth': 'Bu Ay',
        
        // Finans
        'newIncome': 'Yeni Gelir',
        'newExpense': 'Yeni Gider',
        'filters': 'Filtreler',
        'applyFilters': 'Filtrele',
        'clearFilters': 'Temizle',
        'exportExcel': 'Excel Ä°ndir',
        'exportPDF': 'PDF Ä°ndir',
        
        // Toast MesajlarÄ±
        'successSave': 'BaÅŸarÄ±yla kaydedildi!',
        'errorOccurred': 'Bir hata oluÅŸtu!',
        'profileUpdated': 'Profil gÃ¼ncellendi!',
        'passwordChanged': 'Åifre deÄŸiÅŸtirildi!',
        
        // Formlar
        'title': 'BaÅŸlÄ±k',
        'amount': 'Tutar',
        'category': 'Kategori',
        'date': 'Tarih',
        'description': 'AÃ§Ä±klama',
        'status': 'Durum'
    },
    
    en: {
        // General
        'welcome': 'Welcome',
        'logout': 'Logout',
        'save': 'Save',
        'cancel': 'Cancel',
        'delete': 'Delete',
        'edit': 'Edit',
        'search': 'Search...',
        'loading': 'Loading...',
        
        // Menu
        'dashboard': 'Dashboard',
        'finance': 'Finance',
        'facilities': 'Facilities',
        'projects': 'Projects',
        'sacrifice': 'Sacrifice',
        'personnel': 'Personnel',
        'profile': 'Profile',
        'users': 'Users',
        
        // Dashboard
        'overview': 'Overview',
        'totalIncome': 'Total Income',
        'totalExpense': 'Total Expense',
        'balance': 'Balance',
        'activeFacilities': 'Active Facilities',
        'recentTransactions': 'Recent Transactions',
        'thisMonth': 'This Month',
        
        // Finance
        'newIncome': 'New Income',
        'newExpense': 'New Expense',
        'filters': 'Filters',
        'applyFilters': 'Apply',
        'clearFilters': 'Clear',
        'exportExcel': 'Export Excel',
        'exportPDF': 'Export PDF',
        
        // Toast Messages
        'successSave': 'Saved successfully!',
        'errorOccurred': 'An error occurred!',
        'profileUpdated': 'Profile updated!',
        'passwordChanged': 'Password changed!',
        
        // Forms
        'title': 'Title',
        'amount': 'Amount',
        'category': 'Category',
        'date': 'Date',
        'description': 'Description',
        'status': 'Status'
    },
    
    ar: {
        // Ø¹Ø§Ù…
        'welcome': 'Ù…Ø±Ø­Ø¨Ø§',
        'logout': 'ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬',
        'save': 'Ø­ÙØ¸',
        'cancel': 'Ø¥Ù„ØºØ§Ø¡',
        'delete': 'Ø­Ø°Ù',
        'edit': 'ØªØ¹Ø¯ÙŠÙ„',
        'search': 'Ø¨Ø­Ø«...',
        'loading': 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...',
        
        // Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
        'dashboard': 'Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©',
        'finance': 'Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
        'facilities': 'Ø§Ù„Ù…Ù†Ø´Ø¢Øª',
        'projects': 'Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹',
        'sacrifice': 'Ø§Ù„Ø£Ø¶Ø§Ø­ÙŠ',
        'personnel': 'Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
        'profile': 'Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ',
        'users': 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†',
        
        // Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©
        'overview': 'Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©',
        'totalIncome': 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø®Ù„',
        'totalExpense': 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª',
        'balance': 'Ø§Ù„Ø±ØµÙŠØ¯',
        'activeFacilities': 'Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„Ù†Ø´Ø·Ø©',
        'recentTransactions': 'Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©',
        'thisMonth': 'Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±',
        
        // Ø§Ù„Ù…Ø§Ù„ÙŠØ©
        'newIncome': 'Ø¯Ø®Ù„ Ø¬Ø¯ÙŠØ¯',
        'newExpense': 'Ù…ØµØ±ÙˆÙ Ø¬Ø¯ÙŠØ¯',
        'filters': 'Ø§Ù„ÙÙ„Ø§ØªØ±',
        'applyFilters': 'ØªØ·Ø¨ÙŠÙ‚',
        'clearFilters': 'Ù…Ø³Ø­',
        'exportExcel': 'ØªØµØ¯ÙŠØ± Excel',
        'exportPDF': 'ØªØµØ¯ÙŠØ± PDF',
        
        // Ø±Ø³Ø§Ø¦Ù„
        'successSave': 'ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­!',
        'errorOccurred': 'Ø­Ø¯Ø« Ø®Ø·Ø£!',
        'profileUpdated': 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ!',
        'passwordChanged': 'ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±!',
        
        // Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
        'title': 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†',
        'amount': 'Ø§Ù„Ù…Ø¨Ù„Øº',
        'category': 'Ø§Ù„ÙØ¦Ø©',
        'date': 'Ø§Ù„ØªØ§Ø±ÙŠØ®',
        'description': 'Ø§Ù„ÙˆØµÙ',
        'status': 'Ø§Ù„Ø­Ø§Ù„Ø©'
    },
    
    fr: {
        // GÃ©nÃ©ral
        'welcome': 'Bienvenue',
        'logout': 'DÃ©connexion',
        'save': 'Enregistrer',
        'cancel': 'Annuler',
        'delete': 'Supprimer',
        'edit': 'Modifier',
        'search': 'Rechercher...',
        'loading': 'Chargement...',
        
        // Menu
        'dashboard': 'Tableau de bord',
        'finance': 'Finance',
        'facilities': 'Installations',
        'projects': 'Projets',
        'sacrifice': 'Sacrifice',
        'personnel': 'Personnel',
        'profile': 'Profil',
        'users': 'Utilisateurs',
        
        // Tableau de bord
        'overview': 'Vue d\'ensemble',
        'totalIncome': 'Revenu total',
        'totalExpense': 'DÃ©pense totale',
        'balance': 'Solde',
        'activeFacilities': 'Installations actives',
        'recentTransactions': 'Transactions rÃ©centes',
        'thisMonth': 'Ce mois',
        
        // Finance
        'newIncome': 'Nouveau revenu',
        'newExpense': 'Nouvelle dÃ©pense',
        'filters': 'Filtres',
        'applyFilters': 'Appliquer',
        'clearFilters': 'Effacer',
        'exportExcel': 'Exporter Excel',
        'exportPDF': 'Exporter PDF',
        
        // Messages
        'successSave': 'EnregistrÃ© avec succÃ¨s!',
        'errorOccurred': 'Une erreur s\'est produite!',
        'profileUpdated': 'Profil mis Ã  jour!',
        'passwordChanged': 'Mot de passe changÃ©!',
        
        // Formulaires
        'title': 'Titre',
        'amount': 'Montant',
        'category': 'CatÃ©gorie',
        'date': 'Date',
        'description': 'Description',
        'status': 'Statut'
    }
};

// Aktif dil
let currentLanguage = localStorage.getItem('language') || 'tr';

// Dil baÅŸlat
function initLanguage() {
    const savedLang = localStorage.getItem('language') || 'tr';
    setLanguage(savedLang);
}

// Dil deÄŸiÅŸtir
function setLanguage(lang) {
    if (!translations[lang]) {
        console.error('Dil bulunamadÄ±:', lang);
        return;
    }
    
    currentLanguage = lang;
    localStorage.setItem('language', lang);
    
    // HTML lang attribute
    document.documentElement.lang = lang;
    
    // RTL iÃ§in (ArapÃ§a)
    if (lang === 'ar') {
        document.documentElement.dir = 'rtl';
    } else {
        document.documentElement.dir = 'ltr';
    }
    
    // TÃ¼m Ã§evirileri uygula
    translatePage();
    
    // Dil seÃ§ici butonunu gÃ¼ncelle
    updateLanguageButton();
}

// SayfayÄ± Ã§evir
function translatePage() {
    // data-i18n attribute'u olan tÃ¼m elementleri bul
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        const translation = t(key);
        
        if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
            element.placeholder = translation;
        } else {
            element.textContent = translation;
        }
    });
}

// Ã‡eviri al
function t(key) {
    return translations[currentLanguage][key] || key;
}

// Dil seÃ§ici butonunu gÃ¼ncelle
function updateLanguageButton() {
    const btn = document.getElementById('languageToggle');
    if (!btn) return;
    
    const flags = {
        'tr': 'ğŸ‡¹ğŸ‡·',
        'en': 'ğŸ‡¬ğŸ‡§',
        'ar': 'ğŸ‡¸ğŸ‡¦',
        'fr': 'ğŸ‡«ğŸ‡·'
    };
    
    btn.innerHTML = `<span class="text-xl">${flags[currentLanguage]}</span>`;
}

// Dil deÄŸiÅŸtirme menÃ¼sÃ¼nÃ¼ gÃ¶ster
function showLanguageMenu() {
    const languages = [
        { code: 'tr', name: 'TÃ¼rkÃ§e', flag: 'ğŸ‡¹ğŸ‡·' },
        { code: 'en', name: 'English', flag: 'ğŸ‡¬ğŸ‡§' },
        { code: 'ar', name: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', flag: 'ğŸ‡¸ğŸ‡¦' },
        { code: 'fr', name: 'FranÃ§ais', flag: 'ğŸ‡«ğŸ‡·' }
    ];
    
    const menuHtml = `
        <div id="languageMenu" class="absolute top-12 right-0 bg-white rounded-lg shadow-xl p-2 z-50 min-w-[150px]">
            ${languages.map(lang => `
                <button onclick="selectLanguage('${lang.code}')" class="w-full text-left px-4 py-2 hover:bg-purple-50 rounded flex items-center space-x-2 ${currentLanguage === lang.code ? 'bg-purple-100' : ''}">
                    <span>${lang.flag}</span>
                    <span class="text-sm">${lang.name}</span>
                </button>
            `).join('')}
        </div>
    `;
    
    // Ã–nceki menÃ¼yÃ¼ kaldÄ±r
    const oldMenu = document.getElementById('languageMenu');
    if (oldMenu) oldMenu.remove();
    
    // Yeni menÃ¼ ekle
    const container = document.getElementById('languageToggle').parentElement;
    container.style.position = 'relative';
    container.insertAdjacentHTML('beforeend', menuHtml);
    
    // DÄ±ÅŸarÄ± tÄ±klandÄ±ÄŸÄ±nda kapat
    setTimeout(() => {
        document.addEventListener('click', function closeMenu(e) {
            if (!e.target.closest('#languageToggle') && !e.target.closest('#languageMenu')) {
                const menu = document.getElementById('languageMenu');
                if (menu) menu.remove();
                document.removeEventListener('click', closeMenu);
            }
        });
    }, 100);
}

// Dil seÃ§
window.selectLanguage = function(lang) {
    setLanguage(lang);
    const menu = document.getElementById('languageMenu');
    if (menu) menu.remove();
    
    if (window.ToastManager) {
        const langNames = {
            'tr': 'TÃ¼rkÃ§e',
            'en': 'English',
            'ar': 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©',
            'fr': 'FranÃ§ais'
        };
        ToastManager.success(`${langNames[lang]} seÃ§ildi`);
    }
};

// Global export
window.i18n = {
    initLanguage,
    setLanguage,
    t,
    showLanguageMenu,
    getCurrentLanguage: () => currentLanguage
};